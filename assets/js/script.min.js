const navbar=document.querySelector(".navbar"),navToggle=document.querySelector(".navbar__toggle"),navMenu=document.querySelector(".navbar__menu"),navLinks=document.querySelectorAll(".navbar__link"),backToTopBtn=document.getElementById("back-to-top"),initTheme=()=>{const e=localStorage.getItem("theme")||"light";document.documentElement.setAttribute("data-theme",e)};navToggle&&navToggle.addEventListener("click",()=>{navToggle.classList.toggle("active"),navMenu.classList.toggle("active");const e="true"===navToggle.getAttribute("aria-expanded");navToggle.setAttribute("aria-expanded",!e)}),navLinks.forEach(e=>{e.addEventListener("click",()=>{navToggle&&(navToggle.classList.remove("active"),navMenu.classList.remove("active"),navToggle.setAttribute("aria-expanded","false"))})});let lastScrollTop=0;const handleNavbarScroll=()=>{if(!navbar)return;const e=window.scrollY??document.documentElement.scrollTop;e>50?navbar.classList.add("scrolled"):navbar.classList.remove("scrolled"),lastScrollTop=e};document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const t=document.querySelector(this.getAttribute("href"));if(t){const e=t.getBoundingClientRect().top+window.scrollY-80;window.scrollTo({top:e,behavior:"smooth"})}})});const sections=document.querySelectorAll("section[id]"),highlightNavOnScroll=()=>{const e=window.scrollY;sections.forEach(t=>{const n=t.offsetHeight,o=t.offsetTop-100,a=t.getAttribute("id"),c=document.querySelector(`.navbar__link[href="#${a}"]`);e>o&&e<=o+n&&(navLinks.forEach(e=>e.classList.remove("active")),c&&c.classList.add("active"))})},handleBackToTop=()=>{window.scrollY>300?(backToTopBtn?.classList.remove("hidden"),backToTopBtn?.classList.add("block")):(backToTopBtn?.classList.add("hidden"),backToTopBtn?.classList.remove("block"))};backToTopBtn&&backToTopBtn.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});const observerOptions={threshold:.1,rootMargin:"0px 0px -50px 0px"},observer=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting&&(e.target.classList.add("revealed"),e.target.classList.contains("timeline-item"))){e.target.classList.add("visible");const t=100*Array.from(e.target.parentNode.children).indexOf(e.target);e.target.style.transitionDelay=`${t}ms`}})},observerOptions),animateElements=()=>{document.querySelectorAll(".scroll-reveal, .card").forEach(e=>{observer.observe(e)})},initializeTimeline=()=>{document.querySelectorAll(".timeline-item").forEach(e=>{e.classList.add("fade-in-up"),observer.observe(e)})},openSidePanel=e=>{const t=document.getElementById(e),n=document.getElementById("panel-overlay");if(t&&n){t.classList.add("active"),n.classList.add("active"),t.setAttribute("aria-hidden","false");const e=document.querySelector("main"),o=document.querySelector(".navbar");e&&e.setAttribute("inert",""),o&&o.setAttribute("inert","");const a=t.querySelector(".panel-close");a&&a.focus();const c=t.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),r=c[0],l=c[c.length-1];t._trapFocus=e=>{"Tab"===e.key&&(e.shiftKey?document.activeElement===r&&(e.preventDefault(),l.focus()):document.activeElement===l&&(e.preventDefault(),r.focus()))},t.addEventListener("keydown",t._trapFocus),document.addEventListener("keydown",handlePanelEscapeKey),document.body.style.overflow="hidden"}},closeSidePanel=e=>{const t=document.getElementById(e),n=document.getElementById("panel-overlay");if(t&&n){t.classList.remove("active"),n.classList.remove("active"),t.setAttribute("aria-hidden","true");const o=document.querySelector("main"),a=document.querySelector(".navbar");o&&o.removeAttribute("inert"),a&&a.removeAttribute("inert"),t._trapFocus&&t.removeEventListener("keydown",t._trapFocus),document.removeEventListener("keydown",handlePanelEscapeKey),document.body.style.overflow="";const c=document.querySelector(`[data-panel-trigger="${e}"]`);c&&c.focus()}},handlePanelEscapeKey=e=>{if("Escape"===e.key){const e=document.querySelector(".side-panel.active");e&&closeSidePanel(e.id)}};document.addEventListener("click",e=>{const t=e.target.closest("[data-panel-trigger]");if(t)return void openSidePanel(t.dataset.panelTrigger);const n=e.target.closest("[data-panel-close]");if(n)closeSidePanel(n.dataset.panelClose);else if("panel-overlay"===e.target.id&&e.target.classList.contains("active")){const e=document.querySelector(".side-panel.active");e&&closeSidePanel(e.id)}}),window.openSidePanel=openSidePanel,window.closeSidePanel=closeSidePanel;const lazyLoadImages=()=>{const e=document.querySelectorAll("img[data-src]"),t=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const n=e.target;n.src=n.dataset.src,n.removeAttribute("data-src"),t.unobserve(n)}})});e.forEach(e=>t.observe(e))};let ticking=!1;const handleScroll=()=>{ticking||(requestAnimationFrame(()=>{handleNavbarScroll(),highlightNavOnScroll(),handleBackToTop(),ticking=!1}),ticking=!0)},prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches,init=()=>{initTheme(),prefersReducedMotion||(animateElements(),initializeTimeline()),lazyLoadImages(),window.addEventListener("scroll",handleScroll,{passive:!0}),handleNavbarScroll(),highlightNavOnScroll(),handleBackToTop()};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",init):init();